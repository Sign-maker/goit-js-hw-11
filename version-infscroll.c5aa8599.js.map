{"mappings":"iiBAAA,IAAAA,EAAAC,EAAA,S,wGAOMC,EAAUC,SAASC,cAAc,gBACjCC,EAAkBF,SAASC,cAAc,kBACzCE,EAAYH,SAASC,cAAc,YACnCG,EAAYJ,SAASC,cAAc,WAEzCI,EAAAC,GAASC,OAAOC,KAAK,CACnBC,SAAU,OACVC,QAAS,IACTC,cAAc,IAGhB,IAAMC,EAAa,IAAI,EAAAC,EAAAC,YACjBC,EAAe,IAAI,EAAAC,EAAAC,QAAOf,EAAiB,MAC3CgB,EAAW,IAAIb,EAAAc,GAAJ,CAAmB,aAAc,CAAEC,eAAgB,KAEpEL,EAAaM,OAEbtB,EAAQuB,iBAAiB,U,SAUGC,G,OAAbC,EAAYC,MAAAC,KAAAC,U,IAR3B,IAIMC,EAAW,IAAIC,sBAuDrB,SAAyBC,EAASC,GAChCD,EAAQE,S,EAAQ3B,EAAAR,EAAA,CAAAQ,EAAA4B,GAAAC,MAAA,SAAAC,EAAMC,G,IAMZC,E,qEALHD,EAAME,eAAc,C,uDAGzBC,QAAQC,IAAIJ,G,kBAESxB,EAAW6B,W,OAAxBJ,EAAIK,EAAAC,MAEV,EAAAC,EAAAC,cAAa1C,EAAWkC,EAAKS,MAC7B5B,EAAS6B,UAELnC,EAAWoC,aACbpC,EAAWqC,OAAOC,MAAQ,GAE1B7C,EAAAC,GAASC,OAAO4C,QACd,8DAEFpB,EAASqB,UAAUhD,I,kDAGrBmC,QAAQC,IAAGE,EAAAW,IACXhD,EAAAC,GAASC,OAAO+C,QAAQ,0C,mEArBNlB,G,kCAAP,I,IA5DD,CACdmB,WAAY,QACZC,UAAW,I,SAMEhC,I,OAAAA,EAAfnB,EAAAR,EAAA,CAAAQ,EAAA4B,GAAAC,MAAA,SAAAC,EAA4BZ,G,IAGpBkC,EAcEpB,EACAqB,E,qEAjBRnC,EAAIoC,iBAEEF,EAAclC,EAAIqC,OAAOC,SAASJ,YAAYK,MAAMC,OAC1C,C,sBACd1D,EAAAC,GAASC,OAAOyD,QAAQ,6B,iCAG1BpD,EAAWqC,OAAOC,KAAO,EACzBtB,EAASwB,UAAUhD,IACnB,EAAAwC,EAAAqB,aAAY9D,GACZS,EAAWqC,OAAS5C,EAAA6D,EAAA,IAAKtD,EAAWqC,OAAM,CAAEkB,EAAGV,I,SAG7ClC,EAAIqC,OAAOQ,iBAAiBC,UAAW,EACvCtD,EAAauD,O,UAEM1D,EAAW6B,W,WAAxBJ,EAAIK,EAAAC,KACJe,EAAQrB,EAAKkC,UAET,C,uBACRlE,EAAAC,GAASC,OAAO+C,QACd,4E,2BAMJjD,EAAAC,GAASC,OAAO4C,QACd,oBAAkCqB,OAAdd,EAAM,UAA+Bc,OAAb,IAAVd,EAAc,GAAK,IAAI,MAE3D9C,EAAW6D,WAAaC,KAAKC,KAAKjB,EAAQ9C,EAAWqC,OAAO2B,WAC5D,EAAAhC,EAAAC,cAAa1C,EAAWkC,EAAKS,MAC7B5B,EAAS6B,UAELnC,EAAWoC,cACbpC,EAAWqC,OAAOC,MAAQ,EAC1BtB,EAASiD,QAAQzE,IAEjBC,EAAAC,GAASC,OAAO4C,QACd,8D,kDAGJZ,QAAQC,IAAGE,EAAAW,IACXhD,EAAAC,GAASC,OAAO+C,QAAQ,0C,yBAExBvC,EAAaM,OACbE,EAAIqC,OAAOQ,iBAAiBC,UAAW,E,8EA/ChB5C,MAAAC,KAAAC,U,EAF3B,EAAAmD,EAAAC,kB","sources":["src/js/version-infscroll.js"],"sourcesContent":["import Notiflix from 'notiflix';\nimport SimpleLightbox from 'simplelightbox';\nimport { PixabayAPI } from './modules/pixabay-api';\nimport { renderMarkup, clearRender } from './modules/renderHandler';\nimport { Loader } from './modules/loader';\nimport { goTopBtnHandler } from './modules/go-top-btn';\n\nconst formRef = document.querySelector('#search-form');\nconst searchLoaderRef = document.querySelector('.search-loader');\nconst renderRef = document.querySelector('.gallery');\nconst targetRef = document.querySelector('.target');\n\nNotiflix.Notify.init({\n  fontSize: '16px',\n  timeout: 4000,\n  clickToClose: true,\n});\n\nconst pixabayApi = new PixabayAPI();\nconst searchLoader = new Loader(searchLoaderRef, '🔍');\nconst lightbox = new SimpleLightbox('.gallery a', { overlayOpacity: 0.9 });\n\nsearchLoader.hide();\n\nformRef.addEventListener('submit', onFormSubmit);\n\nconst options = {\n  rootMargin: '400px',\n  threshold: 1.0,\n};\nconst observer = new IntersectionObserver(handleIntersect, options);\n\ngoTopBtnHandler();\n\nasync function onFormSubmit(evt) {\n  evt.preventDefault();\n\n  const searchQuery = evt.target.elements.searchQuery.value.trim();\n  if (!searchQuery) {\n    Notiflix.Notify.warning('Plase input search query!');\n    return;\n  }\n  pixabayApi.params.page = 1;\n  observer.unobserve(targetRef);\n  clearRender(renderRef);\n  pixabayApi.params = { ...pixabayApi.params, q: searchQuery };\n\n  try {\n    evt.target.lastElementChild.disabled = true;\n    searchLoader.show();\n\n    const data = await pixabayApi.getCards();\n    const total = data.totalHits;\n\n    if (!total) {\n      Notiflix.Notify.failure(\n        'Sorry, there are no images matching your search query. Please try again.'\n      );\n\n      return;\n    }\n\n    Notiflix.Notify.success(\n      `Hooray! We found ${total} image${total === 1 ? '' : 's'}.`\n    );\n    pixabayApi.totalPages = Math.ceil(total / pixabayApi.params.per_page);\n    renderMarkup(renderRef, data.hits);\n    lightbox.refresh();\n\n    if (pixabayApi.isNextPage()) {\n      pixabayApi.params.page += 1;\n      observer.observe(targetRef);\n    } else\n      Notiflix.Notify.success(\n        \"We're sorry, but you've reached the end of search results.\"\n      );\n  } catch (error) {\n    console.log(error);\n    Notiflix.Notify.failure('Oops, something went wrong, try again!');\n  } finally {\n    searchLoader.hide();\n    evt.target.lastElementChild.disabled = false;\n  }\n}\n\nfunction handleIntersect(entries, observer) {\n  entries.forEach(async entry => {\n    if (!entry.isIntersecting) {\n      return;\n    }\n    console.log(entry);\n    try {\n      const data = await pixabayApi.getCards();\n\n      renderMarkup(renderRef, data.hits);\n      lightbox.refresh();\n\n      if (pixabayApi.isNextPage()) {\n        pixabayApi.params.page += 1;\n      } else {\n        Notiflix.Notify.success(\n          \"We're sorry, but you've reached the end of search results.\"\n        );\n        observer.unobserve(targetRef);\n      }\n    } catch (error) {\n      console.log(error);\n      Notiflix.Notify.failure('Oops, something went wrong, try again!');\n    }\n  });\n}\n"],"names":["$bpxeT","parcelRequire","$f96cf9be961856a8$var$formRef","document","querySelector","$f96cf9be961856a8$var$searchLoaderRef","$f96cf9be961856a8$var$renderRef","$f96cf9be961856a8$var$targetRef","$parcel$interopDefault","$6JpON","Notify","init","fontSize","timeout","clickToClose","$f96cf9be961856a8$var$pixabayApi","$kZWxX","PixabayAPI","$f96cf9be961856a8$var$searchLoader","$ip97o","Loader","$f96cf9be961856a8$var$lightbox","$5IjG7","overlayOpacity","hide","addEventListener","evt","$f96cf9be961856a8$var$_onFormSubmit","apply","this","arguments","$f96cf9be961856a8$var$observer","IntersectionObserver","entries","observer1","forEach","$2TvXO","mark","_callee","entry","data","isIntersecting","console","log","getCards","_ctx","sent","$hSrw4","renderMarkup","hits","refresh","isNextPage","params","page","success","unobserve","t0","failure","rootMargin","threshold","searchQuery","total","preventDefault","target","elements","value","trim","warning","clearRender","$dDDEV","q","lastElementChild","disabled","show","totalHits","concat","totalPages","Math","ceil","per_page","observe","$gx7bW","goTopBtnHandler"],"version":3,"file":"version-infscroll.c5aa8599.js.map"}